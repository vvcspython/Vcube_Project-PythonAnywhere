"use strict";(self.webpackChunkvcube=self.webpackChunkvcube||[]).push([[7352],{27352:(e,s,r)=>{r.r(s),r.d(s,{default:()=>v});var t=r(65043),n=r(83462),a=r(17392),i=r(35316),l=r(94516),o=r(94496),c=r(42788),u=r(29347),d=r(11906),m=r(90573),f=r(66734),p=r(70579);const x=(0,f.A)((0,p.jsx)("path",{d:"m11.19 1.36-7 3.11C3.47 4.79 3 5.51 3 6.3V11c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V6.3c0-.79-.47-1.51-1.19-1.83l-7-3.11c-.51-.23-1.11-.23-1.62 0M12 11.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"SecurityRounded"),h=e=>{let{newPin:s,setNewPin:r,confirmPin:t,setConfirmPin:n,otp:a,setOTP:i,password:u,setpassword:d}=e;return(0,p.jsxs)(l.A,{className:"w-full h-full",children:[(0,p.jsxs)(o.A,{className:"text-center",children:["Enter a New PIN.",(0,p.jsx)("br",{}),"Please keep your PIN safe and secure to protect your account."]}),(0,p.jsx)(c.A,{variant:"standard",type:"password",label:"Your Account Password",className:"h-20 w-[70%]",sx:{margin:"5% 0 0 15%","& .MuiInputBase-input":{fontSize:"24px"},"& .MuiInputLabel-root":{fontSize:"20px"}},value:u,onChange:e=>d(e.target.value)}),(0,p.jsx)(l.A,{className:"w-full h-[65%] flex flex-col items-center justify-evenly",children:["pin","forgot","otp"].map(((e,u)=>(0,p.jsxs)(l.A,{className:"w-[70%] flex flex-col items-center justify-evenly",children:[(0,p.jsx)(o.A,{className:"w-full",children:0===u?"New Pin":1===u?"Confirm Pin":"Enter OTP"}),(0,p.jsx)(l.A,{className:"w-full flex items-center justify-between",children:[0,1,2,3,4,5].map((l=>(0,p.jsx)(c.A,{variant:"standard",id:`${e}-input-${l}`,onChange:o=>((e,l,o)=>{const c=e.target.value;if(/^\d?$/.test(c)){const e="pin"===o?[...s]:"forgot"===o?[...t]:[...a];e[l]=c,"pin"===o?r(e):"forgot"===o?n(e):i(e),c&&l<5&&setTimeout((()=>{document.getElementById(`${o}-input-${l+1}`).focus()}),0)}})(o,l,e),onKeyDown:r=>((e,r,n)=>{"Backspace"===e.key&&""===("pin"===n?s[r]:"forgot"===n?t[r]:a[r])&&r>0&&setTimeout((()=>{document.getElementById(`${n}-input-${r-1}`).focus()}),0)})(r,l,e),type:"password",value:"pin"===e?s[l]:"forgot"===e?t[l]:a[l],inputProps:{maxLength:1},InputProps:{disableUnderline:!0},className:"w-10",sx:{paddingLeft:"1rem",borderBottom:"solid 1px grey","& .MuiInputBase-input":{fontSize:"24px"}}},l)))})]},e)))})]})};var g=r(32514),y=r(54253),w=r(66204);const v=e=>{let{isOpen:s,setIsOpen:r,handleShowSnackbar:f,setIsLoading:v,setIsValidated:P}=e;const{sendEmail:j}=(0,t.useContext)(y.V),{createUserDrivePassword:A,getUserDriveData:N,removeUserLoginData:I}=(0,t.useContext)(w.K),[C,S]=(0,t.useState)(Array(6).fill("")),[b,D]=(0,t.useState)(Array(6).fill("")),[$,k]=(0,t.useState)(Array(6).fill("")),[E,U]=(0,t.useState)(Array(6).fill("")),[V,T]=(0,t.useState)(null),[B,O]=(0,t.useState)(!1),[z,L]=(0,t.useState)(!1),M=(0,g.ID)("All"),R=async()=>{if(v(!0),V&&b.every((e=>e.length>0))&&$.every((e=>e.length>0))&&b.reduce(((e,s)=>e+s))===$.reduce(((e,s)=>e+s))&&E.every((e=>e.length>0))){const e={Email:M.Email,Password:V,DrivePassword:b.reduce(((e,s)=>e+s)),User_Id:`${M.Username}~${M.Email}`,OTP:E.reduce(((e,s)=>e+s))},s=await A(M.Course,M.Username,e);!0===s?(f("success","Drive registration completed successfully. You are now registered for drive access!"),F()):s&&s.message&&(406===s.response.status?f("error","Invalid OTP."):403===s.response.status?f("error","Access Denied."):401===s.response.status?f("error","Invalid Password."):f("error","Something went wrong. Please try again later."))}else b.reduce(((e,s)=>e+s))!==$.reduce(((e,s)=>e+s))?f("error","New PIN and Confirm PIN doesn't match."):f("error","All fields must be completed. Please check and fill them.");v(!1)},F=()=>{T(null),O(!1),L(!1),S(Array(6).fill("")),D(Array(6).fill("")),k(Array(6).fill("")),U(Array(6).fill(""))};return(0,p.jsxs)(n.A,{open:s,sx:{zIndex:"700"},onClose:()=>{F(),r(!1)},children:[(0,p.jsx)("img",{src:"/images/V-Cube-Logo.png",alt:"",width:"15%",className:"ml-[42.5%]"}),(0,p.jsx)(a.A,{sx:{position:"absolute"},className:"top-1 right-1",onClick:()=>{F(),r(!1)},children:(0,p.jsx)(m.A,{fontSize:"large"})}),(0,p.jsx)(i.A,{className:`w-full ${z?"h-[30rem]":"h-[20rem]"} flex flex-col items-center justify-start`,children:z?(0,p.jsx)(h,{newPin:b,setNewPin:D,confirmPin:$,setConfirmPin:k,otp:E,setOTP:U,password:V,setpassword:T}):(0,p.jsxs)(l.A,{className:"w-full h-full flex flex-col items-center justify-start",children:[(0,p.jsx)(x,{sx:{fontSize:"50px"},color:"primary"}),(0,p.jsxs)(o.A,{variant:"h5",sx:{margin:"20px 0"},children:["Hi ",M.Username]}),"Not Registered"===M.Drive?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.A,{className:"text-center",variant:"h6",children:"Registration not found."}),(0,p.jsx)("br",{}),(0,p.jsx)(o.A,{children:"Please register to use the drive services."})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.A,{sx:{margin:"0 0 20px 0"},children:"Please enter the 6-digit PIN to access your drive."}),(0,p.jsx)(l.A,{className:"w-[70%] flex items-center justify-evenly",children:C.map(((e,s)=>(0,p.jsx)(c.A,{id:`pin-input-${s}`,value:C[s],onChange:e=>((e,s)=>{const r=e.target.value;if(/^\d?$/.test(r)){const e=[...C];e[s]=r,S(e),r&&s<C.length-1&&document.getElementById(`pin-input-${s+1}`).focus()}})(e,s),onKeyDown:e=>((e,s)=>{"Backspace"===e.key&&!C[s]&&s>0&&document.getElementById("pin-input-"+(s-1)).focus()})(e,s),type:"password",className:"w-[2.19rem] h-16",sx:{fontSize:"50px","& .MuiInputBase-input":{fontSize:"24px",height:"1.50rem"}},error:B&&!C.every((e=>e.length>0)),inputProps:{maxLength:1}},s)))})]}),(0,p.jsx)(o.A,{sx:{margin:"20px 0"},color:"primary",className:"cursor-pointer hover:underline",onClick:async()=>{v(!0);const e=await j(" ",M.Email,"OTP for Creating Your Drive Password",M.Username,"OTP",`${M.Username}~${M.Email}`);v(!1),!0===e?(f("success","OTP has been successfully sent to your Email address. Check spam folder too if not found."),L(!0)):(f("error","Something went wrong. Please try again later."),r(!1))},children:"Not Registered"===M.Drive?"Register":"Forgot PIN?"})]})}),(0,p.jsxs)(u.A,{children:[(0,p.jsx)(d.A,{variant:"outlined",onClick:()=>{F(),!z&&r(!1)},children:"Cancel"}),(0,p.jsx)(d.A,{variant:"contained",onClick:()=>{z?R():(async()=>{if(O(!0),!C.every((e=>e.length>0)))return;O(!1),v(!0);const e={Email:M.Email,DrivePassword:(0,g.iy)(C.reduce(((e,s)=>e+s)))},s=await N(M.Course,M.Username,e,"Validate");v(!1),!0===s?(P(!0),f("success","Verification successful. Drive access granted."),setTimeout((()=>{f("success",`Dear ${M.Username}. Welcome to your drive!`)}),1e3)):s&&s.message&&(403===s.response.status?f("error","Verification failed. Access Denied."):401===s.response.status?f("error","Verification failed. Invalid Pin."):f("error",`Verification failed. ${s.message}`),F(),r(!1))})()},children:"Submit"})]})]})}}}]);
//# sourceMappingURL=7352.1e3d8f55.chunk.js.map