"use strict";(self.webpackChunkvcube=self.webpackChunkvcube||[]).push([[6354],{2281:(e,t,a)=>{a.d(t,{m:()=>l});var s=a(94516),r=a(34535),n=a(70579);const o=(0,r.Ay)("div")((e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%","& .no-rows-primary":{fill:"#3D4751",...t.applyStyles("light",{fill:"#AEB8C2"})},"& .no-rows-secondary":{fill:"#1D2126",...t.applyStyles("light",{fill:"#E8EAED"})}}})),l=()=>(0,n.jsxs)(o,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",width:96,viewBox:"0 0 452 257","aria-hidden":!0,focusable:"false",children:[(0,n.jsx)("path",{className:"no-rows-primary",d:"M348 69c-46.392 0-84 37.608-84 84s37.608 84 84 84 84-37.608 84-84-37.608-84-84-84Zm-104 84c0-57.438 46.562-104 104-104s104 46.562 104 104-46.562 104-104 104-104-46.562-104-104Z"}),(0,n.jsx)("path",{className:"no-rows-primary",d:"M308.929 113.929c3.905-3.905 10.237-3.905 14.142 0l63.64 63.64c3.905 3.905 3.905 10.236 0 14.142-3.906 3.905-10.237 3.905-14.142 0l-63.64-63.64c-3.905-3.905-3.905-10.237 0-14.142Z"}),(0,n.jsx)("path",{className:"no-rows-primary",d:"M308.929 191.711c-3.905-3.906-3.905-10.237 0-14.142l63.64-63.64c3.905-3.905 10.236-3.905 14.142 0 3.905 3.905 3.905 10.237 0 14.142l-63.64 63.64c-3.905 3.905-10.237 3.905-14.142 0Z"}),(0,n.jsx)("path",{className:"no-rows-secondary",d:"M0 10C0 4.477 4.477 0 10 0h380c5.523 0 10 4.477 10 10s-4.477 10-10 10H10C4.477 20 0 15.523 0 10ZM0 59c0-5.523 4.477-10 10-10h231c5.523 0 10 4.477 10 10s-4.477 10-10 10H10C4.477 69 0 64.523 0 59ZM0 106c0-5.523 4.477-10 10-10h203c5.523 0 10 4.477 10 10s-4.477 10-10 10H10c-5.523 0-10-4.477-10-10ZM0 153c0-5.523 4.477-10 10-10h195.5c5.523 0 10 4.477 10 10s-4.477 10-10 10H10c-5.523 0-10-4.477-10-10ZM0 200c0-5.523 4.477-10 10-10h203c5.523 0 10 4.477 10 10s-4.477 10-10 10H10c-5.523 0-10-4.477-10-10ZM0 247c0-5.523 4.477-10 10-10h231c5.523 0 10 4.477 10 10s-4.477 10-10 10H10c-5.523 0-10-4.477-10-10Z"})]}),(0,n.jsx)(s.A,{sx:{mt:2},children:"No rows"})]})},96354:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var s=a(65043),r=a(17392),n=a(81045),o=a(94516),l=a(83462),c=a(35316),i=a(94496),d=a(29347),h=a(11906),m=a(85559),u=a(11238),p=a(73216),f=a(88076),x=a(35741),A=a(18921),g=a(3632),w=a(90573),N=a(26600),S=a(98533),y=a(69413),C=a(74605),j=a(51962),_=a(9971),I=a(77212),b=a(70579);const D=e=>{let{isOpen:t,setIsOpen:a,stdData:n,handleShowSnackbar:o,setIsLoading:m,fetchStdData:u,studentAttData:p,selectedCourse:A,selectedBatch:g,refreshData:D}=e;const{postStudentAttendance:v}=(0,s.useContext)(f.e),{fetchBatchAttendanceDataByCourse:k}=(0,s.useContext)(I.N),[B,E]=(0,s.useState)([]),M=(0,s.useRef)([]),O=(0,_.c)().split(" ");(0,s.useEffect)((()=>{(0,s.startTransition)((()=>{A&&g&&(async()=>{m(!0);const e=await k(A);m(!1),e&&"Network Error"===e.message?o("error",e.message):M.current=e})()}))}),[g,t]);const P=e=>Array.isArray(M.current)&&M.current.some((t=>t.BatchName===g&&t.Date===O[0]&&t.Attendance_Type===e)),T=()=>{E([]),a(!1),m(!1)};return(0,b.jsxs)(l.A,{open:t,sx:{zIndex:"700"},children:[(0,b.jsx)("img",{src:"/images/V-Cube-Logo.png",width:"20%",alt:"",className:"ml-[40%]"}),(0,b.jsx)(r.A,{sx:{position:"absolute"},onClick:T,className:"top-3 right-3",children:(0,b.jsx)(w.A,{sx:{fontSize:"30px"}})}),(0,b.jsx)(N.A,{variant:"h5",children:"Student Attendance"}),(0,b.jsx)(c.A,{children:(0,b.jsx)(S.A,{children:(0,b.jsx)(y.A,{children:["Class","Mock Test","Interview"].map((e=>{return(0,b.jsx)(C.A,{control:(t=e,Array.isArray(n)&&n.some((e=>Array.isArray(p)&&p.some((a=>a.StudentId===e.id&&a.Name===`${e.Name}~${e.Phone}`&&a.BatchName===e.BatchName&&a.Date===O[0]&&a.Attendance_Type===t))))?(0,b.jsx)(x.A,{color:"success",sx:{transform:"scale(1.2)",margin:"10px 10px 10px 10px"}}):(0,b.jsx)(j.A,{sx:{transform:"scale(1.2)"},disabled:!P(e),onChange:t=>t.target.checked?E((t=>[...t,e])):E(B.filter((t=>t!==e)))})),label:(0,b.jsxs)(i.A,{sx:{fontSize:"20px",marginLeft:"15px",userSelect:"none"},children:["Mock Test"===e?"Weekly Test":e," Attendance"]})});var t}))})})}),(0,b.jsx)(d.A,{sx:{margin:"10px 0 20px 0"},children:(0,b.jsx)(h.A,{variant:"contained",sx:{width:"90%",marginRight:"5%",height:"40px"},onClick:async()=>{if(!B||B&&0===B.length)o("error","Select alteast one option to take an Attendance.");else{a(!1),m(!0);const e=[];for(const a of n)for(const t of B){const s={StudentId:a.id,Name:`${a.Name}~${a.Phone}`,Course:a.Course,BatchName:a.BatchName,Date:O[0],Attendance_Type:t};e.push(s)}const t=await v(e);t&&t.message?o("error",t.message):(D(),o("success","Student Attendance added successfully."),T())}m(!1),u()},children:"Add Attendance"})})]})};var v=a(2281);const k=e=>{let{studentsData:t,setStudentsData:a,selectedCourse:N,selectedBatch:S,setIsLoading:y,handleShowSnackbar:C,importData:j,setImportData:I,takeStdAtt:k,setTakeStdAtt:B,openStdAttDialog:E,setOpenStdAttDialog:M,refresh:O,stdAttViewType:P,refreshData:T}=e;const{fetchStudentsData:$,getStudentAttendanceByCourse:z}=(0,s.useContext)(f.e),[J,R]=(0,s.useState)([]),[Z,G]=(0,s.useState)([]),[H,L]=(0,s.useState)([]),[F,V]=(0,s.useState)(null),[W,Y]=(0,s.useState)(null),U=(0,p.Zp)(),q=(0,_.c)().split(" "),K=async()=>{y(!0);try{const[e,t]=await Promise.all([$(N),z(N)]);e&&e.message?(C("error",e.message),a([])):(a(Array.isArray(e)?e.filter((e=>e.BatchName===S||"All"===S)):[]),G(t))}catch(e){C("error","Failed to fetch Student data"),a([]),G([])}finally{y(!1)}};(0,s.useEffect)((()=>{N&&S&&K()}),[y,N,S,O]);(0,s.useEffect)((()=>{k&&(()=>{if(!J||Array.isArray(J)&&0===J.length)C("warning","Select atleast one Student to take an Attendance."),B(!1);else{y(!0);const e=[];J.forEach((a=>{e.push(t[a-1])})),L(e),M(!0)}})(),B(!1)}),[k]);const Q=e=>Array.isArray(Z)&&Z.some((t=>t.StudentId===e.id&&t.BatchName===e.BatchName&&`${e.Name}~${e.Phone}`===t.Name&&t.Date===q[0]&&t.Attendance_Type===("Weekly Test"===P?"Mock Test":P))),X=(0,s.useCallback)((e=>{const a=sessionStorage.getItem("UniqueURL");y(!0),sessionStorage.setItem("StudentDetails_ID",JSON.stringify(t[e-1].id)),setTimeout((()=>{U(`/vcube/student-info/${a.substring(60,90)}`)}),1e3)}),[t,U,y]),ee=(0,s.useMemo)((()=>[{field:"id",headerName:"ID",width:50,headerClassName:"text-lg"},{field:"image",headerName:"",width:50,sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,b.jsx)(r.A,{onClick:()=>{return t=e.row.id,a=e.row.image,s=e.row.name,V(a),void Y(`${t}~${s}`);var t,a,s},sx:{width:"100%",height:"100%"},children:(0,b.jsx)(n.A,{alt:e.row.name,src:e.row.image})})},{field:"name",headerName:"Name",width:200,headerClassName:"text-lg"},{field:"batch",headerName:"Batch",width:180,headerClassName:"text-lg"},{field:"phone",headerName:"Phone",width:150,headerClassName:"text-lg"},{field:"email",headerName:"Email",width:260,headerClassName:"text-lg"},{field:"highest_Degree",headerName:"Highest Degree",width:170,headerClassName:"text-lg"},{field:"passout_Year",headerName:"Passout Year",width:130,headerClassName:"text-lg"},{field:"attendance",headerName:"Attendance",width:60,headerClassName:"text-lg",renderCell:e=>e.row.attendance?(0,b.jsx)(x.A,{color:"success"}):(0,b.jsx)(A.A,{color:"error"})},{field:"view",headerName:"View",width:60,headerClassName:"text-lg",sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,b.jsx)(r.A,{onClick:()=>X(e.row.id),children:(0,b.jsx)(g.A,{})})}]),[X]),te=(0,s.useMemo)((()=>t.reduce(((e,t,a)=>(t.BatchName!==S&&"All"!==S||e.push({id:a+1,image:JSON.parse(t.Personal_Info).Image||"",batch:t.BatchName,name:t.Name,phone:t.Phone,email:t.Email,highest_Degree:"object"===typeof t.Educational_Info?"":JSON.parse(t.Educational_Info).PG_Specialization?JSON.parse(t.Educational_Info).PG_Specialization:JSON.parse(t.Educational_Info).Degree_Specialization,passout_Year:"object"===typeof t.Educational_Info?"":JSON.parse(t.Educational_Info).PG_Specialization?JSON.parse(t.Educational_Info).PG_Passed_Year:JSON.parse(t.Educational_Info).Degree_Passed_Year,attendance:Q(t),status:t.Status}),e)),[])),[t,S,Q]);(0,s.useEffect)((()=>{if(j){if(!N)return void C("error","Please choose a preferred course before exporting the student data.");{const e=[];t&&t.forEach((t=>{if(t.Course===N&&(t.BatchName===S||"All"===S)){const a={personalInfo:JSON.parse(t.Personal_Info)};"object"!==typeof t.Educational_Info&&(a.educationalInfo=JSON.parse(t.Educational_Info)),"object"!==typeof t.Placement_Info&&(a.placementInfo=JSON.parse(t.Placement_Info)),e.push(a)}}));(async e=>{const t=u.Wp.book_new(),a=u.Wp.json_to_sheet(e);u.Wp.book_append_sheet(t,a,"Sheet1");const s=`VCUbe_${N}_${S}_Students_Data.xlsx`;u._h(t,s),C("success","Data Imported Successfully"),y(!1)})(e.map((e=>{const{Image:t,Resume:a,...s}=e.personalInfo||"",{Skills:r,Cities:n,...o}=e.placementInfo||"";return{...s,...e.educationalInfo,Skills:Array.isArray(r)?r.join(", "):"",Cities:Array.isArray(n)?n.join(", "):"",...o}})))}}I(!1)}),[j]);return(0,b.jsxs)(o.A,{className:"relative w-[96%] max-h-[61%] h-[61%] ml-[2%] bg-white",children:[te.length>0&&(0,b.jsx)("img",{src:"/images/V-Cube-Logo.png",alt:"",width:"50%",className:"absolute top-0 left-[25%] h-full object-scale-down opacity-20"}),(0,b.jsx)(m.z,{rows:te,columns:ee,getRowClassName:e=>"Active"!==e.row.status?"highlight-row":"",sx:{cursor:"pointer"},slots:{noRowsOverlay:v.m},initialState:{pagination:{paginationModel:{page:0,pageSize:100}}},isRowSelectable:e=>(e=>{const t=Array.isArray(Z)&&Z.some((t=>`${e.name}~${e.phone}`===t.Name&&t.BatchName===e.batch&&t.Date===q[0]&&"Class"===t.Attendance_Type)),a=Array.isArray(Z)&&Z.some((t=>`${e.name}~${e.phone}`===t.Name&&t.BatchName===e.batch&&t.Date===q[0]&&"Mock Test"===t.Attendance_Type)),s=Array.isArray(Z)&&Z.some((t=>`${e.name}~${e.phone}`===t.Name&&t.BatchName===e.batch&&t.Date===q[0]&&"Interview"===t.Attendance_Type));return!(t&&a&&s||"Active"!==e.status)})(e.row),pageSizeOptions:[5,10],checkboxSelection:!0,onRowSelectionModelChange:e=>R(e)}),(0,b.jsx)(D,{isOpen:E,setIsOpen:M,stdData:H,handleShowSnackbar:C,setIsLoading:y,fetchStdData:K,studentAttData:Z,studentsData:t,selectedCourse:N,selectedBatch:S,refreshData:T}),(0,b.jsxs)(l.A,{open:null!==F&&null!==W,onClose:()=>{V(null),Y(null)},sx:{zIndex:"700"},children:[(0,b.jsxs)(c.A,{className:"flex flex-col items-center justify-between",sx:{padding:"10px"},children:[(0,b.jsx)(i.A,{variant:"h4",className:"w-full text-center",children:null!==W&&W.split("~")[1]}),(0,b.jsx)("img",{src:F,className:"mt-5 mb-5 rounded-md",alt:""})]}),(0,b.jsxs)(d.A,{children:[(0,b.jsx)(h.A,{sx:{width:"100%"},variant:"outlined",endIcon:(0,b.jsx)(w.A,{}),onClick:()=>{V(null),Y(null)},children:"Close"}),(0,b.jsx)(h.A,{sx:{width:"100%"},variant:"outlined",endIcon:(0,b.jsx)(g.A,{}),onClick:()=>X(null!==W&&W.split("~")[0]),children:"View"})]})]})]})}},69413:(e,t,a)=>{a.d(t,{A:()=>f});var s=a(65043),r=a(58387),n=a(98610),o=a(34535),l=a(28249),c=a(92532),i=a(72372);function d(e){return(0,i.Ay)("MuiFormGroup",e)}(0,c.A)("MuiFormGroup",["root","row","error"]);var h=a(85213),m=a(74827),u=a(70579);const p=(0,o.Ay)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),f=s.forwardRef((function(e,t){const a=(0,l.b)({props:e,name:"MuiFormGroup"}),{className:s,row:o=!1,...c}=a,i=(0,h.A)(),f=(0,m.A)({props:a,muiFormControl:i,states:["error"]}),x={...a,row:o,error:f.error},A=(e=>{const{classes:t,row:a,error:s}=e,r={root:["root",a&&"row",s&&"error"]};return(0,n.A)(r,d,t)})(x);return(0,u.jsx)(p,{className:(0,r.A)(A.root,s),ownerState:x,ref:t,...c})}))}}]);
//# sourceMappingURL=6354.d0cb5bd6.chunk.js.map