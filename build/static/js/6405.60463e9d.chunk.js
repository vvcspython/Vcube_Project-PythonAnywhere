"use strict";(self.webpackChunkvcube=self.webpackChunkvcube||[]).push([[6405],{46405:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(65043),r=a(82579),n=a(94516),l=a(42788),c=a(11906),i=a(58390),o=a(43245),u=a(4145),h=a(88076),d=a(77212),f=a(70579);const y=e=>{let{setIsLoading:t,handleShowSnackbar:a}=e;const{fetchStudentsData:y,getStudentAttendanceByCourse:A}=(0,s.useContext)(h.e),{fetchBatchAttendanceDataByCourse:g}=(0,s.useContext)(d.N),[p,x]=(0,s.useState)(new Date),[w,C]=(0,s.useState)([]),[S,m]=(0,s.useState)([]),[v,$]=(0,s.useState)([]),[b,k]=(0,s.useState)(Array(12).fill(0)),j=sessionStorage.getItem("SelectedCourse"),D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];(0,s.useEffect)((()=>{j&&(async()=>{t(!0);try{const[e,t,s]=await Promise.all([y(j),A(j),g(j)]);e&&e.message?(a("error",e.message),m([])):(m(e),C(t),$(s))}catch(e){a("error","Failed to fetch Student data"),m([]),C([])}finally{t(!1)}})()}),[t,p]);const I=()=>{D.forEach(((e,t)=>{const a={Class:0,"Mock Test":0,Interview:0};Array.isArray(S)&&S.length>0&&S.forEach((t=>{["Class","Mock Test","Interview"].forEach((s=>{let r=0;Array.isArray(w)&&w.length>0&&w.forEach((a=>{a.StudentId===t.id&&a.Name===`${t.Name}~${t.Phone}`&&a.Attendance_Type===s&&`${a.Date.split("-")[1]}-${a.Date.split("-")[2]}`===`${e}-${p.getFullYear()}`&&r++})),a[s]+=r}))})),M(a,e,t)}))},M=(e,t,a)=>{const s=Array.isArray(S)?S.length:0,r=T(t,"Class")*s,n=T(t,"Mock Test")*s,l=T(t,"Interview")*s,c=(e.Class>0&&r>0?e.Class/r*100:0)+(e["Mock Test"]>0&&n>0?e["Mock Test"]/n*100:0)+(e.Interview>0&&l>0?e.Interview/l*100:0),i=c>0?Math.floor(c/300*100):0;k((e=>{const t=[...e];return t[a]=Math.floor(i),t}))},T=(e,t)=>Array.isArray(v)&&v.length?v.filter((a=>a.Course===j&&a.Attendance_Type===t&&`${a.Date.split("-")[1]}-${a.Date.split("-")[2]}`===`${e}-${p.getFullYear()}`)).length:0;return(0,s.useEffect)((()=>{I()}),[p]),(0,f.jsxs)(n.A,{className:"w-full mt-10 flex flex-col items-center justify-around",children:[(0,f.jsx)(r.b,{xAxis:[{scaleType:"point",data:D}],series:[{data:b,area:!0,label:`Detailed ${p&&p.getFullYear()} Performance Analysis.`}],width:950,height:300}),(0,f.jsxs)(n.A,{className:"w-1/2 flex items-center justify-between",children:[(0,f.jsx)(i.$,{dateAdapter:o.h,children:(0,f.jsx)(u.l,{views:["year"],label:"Select Year",value:p,onChange:e=>x(e),renderInput:e=>(0,f.jsx)(l.A,{...e})})}),(0,f.jsx)(c.A,{variant:"contained",sx:{borderRadius:"25px",width:"40%",height:"40px"},onClick:I,children:"Get Results"})]})]})}}}]);
//# sourceMappingURL=6405.60463e9d.chunk.js.map